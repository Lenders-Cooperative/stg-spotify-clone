{% extends "content/base.html" %}
{% load static %}

{% block title %}
    Dashboard
{% endblock %}

{% block header %}
    Dashboard
{% endblock %}

{% block content %}
    <div class="chart-container">
        {% if genre_charts %}<h2>Top Genres</h2>{% endif %}
        {% for chart in genre_charts %}
        <canvas id="{{chart.id}}" width="400" height="400"></canvas>
        {% endfor %}
        {% if songs_chart %}<h2> Top Songs</h2>{% endif %}
        {% for chart in songs_chart %}
        <canvas id="{{chart.id}}" width="400" height="400"></canvas>
        {% endfor %}
        {% if top_ten_artists %}<h2> Top Artists </h2>{% endif %}
        {% for chart in top_ten_artists %}
        <canvas id="{{chart.id}}" width="400" height="400"></canvas>
        {% endfor %}
    </div>
{% endblock %}

{% block scripts %}
    {{ block.super }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" integrity="sha512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>$(document).ready(function () {
        let ctx, myChart;
        {% for chart in genre_charts %}
        ctx = document.getElementById('{{chart.id}}').getContext('2d');
        console.log('{{chart.labels}}');
        myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: JSON.parse(`{{ chart.labels|safe }}`),
                datasets: [{
                    label: '{{chart.label}}',
                    data: JSON.parse(`{{ chart.data|safe }}`),
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
                {% endfor %}


                {% for chart in songs_chart %}

                ctx = document.getElementById('{{chart.id}}').getContext('2d');
                myChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: JSON.parse(`{{ chart.labels|safe }}`),
                        datasets: [{
                            label: '{{chart.label}}',
                            data: JSON.parse(`{{ chart.data|safe }}`),
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.2)',
                                'rgba(54, 162, 235, 0.2)',
                                'rgba(255, 206, 86, 0.2)',
                                'rgba(75, 192, 192, 0.2)',
                                'rgba(153, 102, 255, 0.2)',
                                'rgba(255, 159, 64, 0.2)'
                                ],
                                borderColor: [
                                    'rgba(255, 99, 132, 1)',
                                    'rgba(54, 162, 235, 1)',
                                    'rgba(255, 206, 86, 1)',
                                    'rgba(75, 192, 192, 1)',
                                    'rgba(153, 102, 255, 1)',
                                    'rgba(255, 159, 64, 1)'
                                    ],
                                    borderWidth: 1
                                }]
                            },
                            options: {
                                scales: {
                                    y: {
                                        beginAtZero: true
                                    }
                                }
                            }
                        });
                        {% endfor %}



                        {% for chart in top_ten_artists %}
        ctx = document.getElementById('{{chart.id}}').getContext('2d');
        myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: JSON.parse(`{{ chart.labels|safe }}`),
                datasets: [{
                    label: '{{chart.label}}',
                    data: JSON.parse(`{{ chart.data|safe }}`),
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
                {% endfor %}



            });
    </script>
{% endblock %}
